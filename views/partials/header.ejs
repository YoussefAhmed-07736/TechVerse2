<%
    // Helper to extract username, available within this partial
    let displayUsername = '';
    if (typeof user !== 'undefined' && user && user.email) {
        displayUsername = user.email.split('@')[0];
    }
%>
<section id="header">
    <a href="/"><img src="/Images/Logo/Logo2.png" width="286px" height="82px" class="Logo" alt="TechVerse Logo"></a>
    <div>
        <ul id="Navigation_Bar">
            <li><a class="<%= typeof currentPage !== 'undefined' && currentPage === 'home' ? 'active' : '' %>" href="/">Home</a></li>
            <li><a class="<%= typeof currentPage !== 'undefined' && currentPage === 'shop' ? 'active' : '' %>" href="/shop">Shop</a></li>
            <li><a class="<%= typeof currentPage !== 'undefined' && currentPage === 'about' ? 'active' : '' %>" href="/about">About</a></li>
            <li><a class="<%= typeof currentPage !== 'undefined' && currentPage === 'contact' ? 'active' : '' %>" href="/contact">Contact Us</a></li>
            

            <% if (user) { %>
                
                <li>
                    <a href="<%= user.role === 'Admin' ? '/admin' : '#' %>">
                        <i class="fa-solid fa-user"></i> <%= displayUsername %>
                    </a>
                </li>
                <li><a href="#" id="logoutLink"><i class="fa-solid fa-right-from-bracket"></i> Logout</a></li>
            <% } else { %>
                <li><a class="<%= typeof currentPage !== 'undefined' && currentPage === 'login' ? 'active' : '' %>" href="/login">Log In</a></li>
            <% } %>
            
            <li><a class="<%= typeof currentPage !== 'undefined' && currentPage === 'cart' ? 'active' : '' %>" href="/cart"><i class="fa-solid fa-bag-shopping"></i></a></li>
        </ul>
    </div>
</section>

<style>
    .message {
        padding: 10px;
        margin-bottom: 20px;
        border-radius: 5px;
        text-align: center;
        font-weight: bold;
        opacity: 0;
        transition: opacity 0.5s ease-in-out;
        margin-top: 20px;
    }
    .message.visible {
        opacity: 1;
    }
    .success-message {
        background-color: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
    }
    .error-message {
        background-color: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
    }

    .modal {
        display: none; 
        position: fixed; 
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%; 
        height: 100%; 
        overflow: auto;
        background-color: rgba(0,0,0,0.4);
        align-items: center;
        justify-content: center;
    }
    .modal-content {
        background-color: #fefefe;
        margin: auto;
        padding: 20px;
        border: 1px solid #888;
        width: 80%;
        max-width: 400px;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        text-align: center;
    }
    .modal-content h3 {
        margin-top: 0;
        margin-bottom: 15px;
        color: #333;
    }
    .modal-content p {
        margin-bottom: 20px;
        color: #555;
    }
    .modal-buttons {
        display: flex;
        justify-content: center;
        gap: 15px;
    }
    .modal-buttons button {
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 1em;
        transition: background-color 0.3s ease;
    }
    .modal-buttons .confirm-btn {
        background-color: #28a745;
        color: white;
    }
    .modal-buttons .confirm-btn:hover {
        background-color: #218838;
    }
    .modal-buttons .cancel-btn {
        background-color: #6c757d;
        color: white;
    }
    .modal-buttons .cancel-btn:hover {
        background-color: #5a6268;
    }
</style>